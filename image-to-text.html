<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OCR Tool - Image to Text</title>
  <style>
    :root {
      --primary: #3b82f6;
      --primary-hover: #2563eb;
      --success: #10b981;
      --error: #ef4444;
      --warning: #f59e0b;
      --bg: #f8fafc;
      --card: #ffffff;
      --text: #1e293b;
      --text-light: #64748b;
      --border: #e2e8f0;
      --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background-color: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      width: 100%;
      max-width: 800px;
      background: var(--card);
      padding: 2rem;
      border-radius: 20px;
      box-shadow: var(--shadow);
    }

    .header {
      text-align: center;
      margin-bottom: 2rem;
    }

    h1 {
      font-size: 2.2rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    .subtitle {
      color: var(--text-light);
      font-size: 1rem;
    }

    /* Upload Area */
    .upload-container {
      border: 3px dashed var(--border);
      border-radius: 16px;
      padding: 2.5rem 2rem;
      text-align: center;
      margin-bottom: 2rem;
      cursor: pointer;
      transition: all 0.3s ease;
      background: linear-gradient(145deg, #ffffff, #f8fafc);
    }

    .upload-container:hover {
      border-color: var(--primary);
      transform: translateY(-2px);
    }

    .upload-container.dragover {
      border-color: var(--success);
      background: #f0f9ff;
    }

    .upload-icon {
      font-size: 3.5rem;
      color: var(--primary);
      margin-bottom: 1rem;
      opacity: 0.8;
    }

    .upload-text h3 {
      margin-bottom: 0.5rem;
      color: var(--text);
    }

    .upload-text p {
      color: var(--text-light);
      font-size: 0.9rem;
      margin-bottom: 1.5rem;
    }

    .upload-btn {
      background: var(--primary);
      color: white;
      padding: 12px 24px;
      border-radius: 10px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .upload-btn:hover {
      background: var(--primary-hover);
      transform: translateY(-1px);
    }

    input[type="file"] {
      display: none;
    }

    /* Preview */
    .preview-container {
      margin-bottom: 2rem;
      display: none;
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .preview-header h3 {
      color: var(--text);
    }

    .preview-actions {
      display: flex;
      gap: 10px;
    }

    .preview-btn {
      padding: 6px 12px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .remove-btn {
      background: #fee2e2;
      color: var(--error);
    }

    .remove-btn:hover {
      background: var(--error);
      color: white;
    }

    #preview {
      max-width: 100%;
      max-height: 300px;
      border-radius: 12px;
      display: block;
      margin: 0 auto;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    /* Settings */
    .settings-panel {
      background: white;
      border-radius: 16px;
      padding: 1.5rem;
      border: 1px solid var(--border);
      margin-bottom: 2rem;
    }

    .settings-panel h3 {
      margin-bottom: 1rem;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .setting-group {
      margin-bottom: 1.5rem;
    }

    .setting-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text);
    }

    select {
      width: 100%;
      padding: 10px 16px;
      border-radius: 10px;
      border: 2px solid var(--border);
      background: white;
      font-size: 1rem;
      cursor: pointer;
    }

    select:focus {
      outline: none;
      border-color: var(--primary);
    }

    /* Process Button */
    .process-btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, var(--primary), var(--primary-hover));
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 2rem;
    }

    .process-btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(37, 99, 235, 0.2);
    }

    .process-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* Progress */
    .progress-container {
      background: white;
      border-radius: 16px;
      padding: 1.5rem;
      border: 1px solid var(--border);
      margin-bottom: 2rem;
      display: none;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .progress-bar {
      height: 10px;
      background: #e2e8f0;
      border-radius: 5px;
      overflow: hidden;
      margin-bottom: 1rem;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--success));
      width: 0%;
      border-radius: 5px;
      transition: width 0.3s ease;
    }

    .progress-info {
      display: flex;
      justify-content: space-between;
      font-size: 0.9rem;
      color: var(--text-light);
    }

    /* Output */
    .output-container {
      background: white;
      border-radius: 16px;
      padding: 1.5rem;
      border: 1px solid var(--border);
      display: none;
    }

    .output-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .output-stats {
      display: flex;
      gap: 15px;
    }

    .stat-item {
      background: #f1f5f9;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.9rem;
      color: var(--text);
    }

    #output {
      width: 100%;
      min-height: 200px;
      max-height: 400px;
      padding: 1rem;
      border: 2px solid var(--border);
      border-radius: 12px;
      font-family: 'Courier New', monospace;
      font-size: 1rem;
      line-height: 1.6;
      resize: vertical;
      overflow-y: auto;
      background: #f8fafc;
      color: var(--text);
      margin-bottom: 1.5rem;
    }

    .output-actions {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }

    @media (max-width: 768px) {
      .output-actions {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .action-btn {
      padding: 12px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s ease;
    }

    .copy-btn {
      background: var(--primary);
      color: white;
    }

    .copy-btn:hover {
      background: var(--primary-hover);
    }

    .save-btn {
      background: var(--success);
      color: white;
    }

    .save-btn:hover {
      background: #0ea271;
    }

    .clear-btn {
      background: #64748b;
      color: white;
    }

    .clear-btn:hover {
      background: #475569;
    }

    .download-btn {
      background: var(--warning);
      color: white;
    }

    .download-btn:hover {
      background: #d97706;
    }

    /* Status */
    .status-container {
      margin: 1rem 0;
      min-height: 24px;
    }

    #statusText {
      text-align: center;
      font-size: 0.9rem;
      padding: 10px;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .status-info {
      color: var(--primary);
      background: #eff6ff;
    }

    .status-success {
      color: var(--success);
      background: #ecfdf5;
    }

    .status-error {
      color: var(--error);
      background: #fef2f2;
    }

    .status-warning {
      color: var(--warning);
      background: #fffbeb;
    }

    /* Footer */
    .footer {
      text-align: center;
      margin-top: 2rem;
      padding-top: 2rem;
      border-top: 1px solid var(--border);
      color: var(--text-light);
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    /* Loader */
    .loader {
      width: 20px;
      height: 20px;
      border: 3px solid rgba(59, 130, 246, 0.2);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (max-width: 640px) {
      .container {
        padding: 1.5rem;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      .upload-container {
        padding: 2rem 1.5rem;
      }
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

<div class="container">
  <div class="header">
    <h1>OCR Image to Text</h1>
    <p class="subtitle">Extract text from images with high accuracy</p>
  </div>

  <!-- Upload Area -->
  <div class="upload-container" id="uploadContainer">
    <div class="upload-icon">
      <i class="fas fa-cloud-upload-alt"></i>
    </div>
    <div class="upload-text">
      <h3>Upload Your Image</h3>
      <p>Drag & drop or click to browse</p>
      <p style="font-size: 0.85rem; color: #94a3b8;">Supported: JPG, PNG, WEBP, BMP (Max 10MB)</p>
    </div>
    <button class="upload-btn" onclick="document.getElementById('imageInput').click()">
      <i class="fas fa-folder-open"></i> Browse Files
    </button>
    <input type="file" id="imageInput" accept="image/*" />
  </div>

  <!-- Image Preview -->
  <div class="preview-container" id="previewContainer">
    <div class="preview-header">
      <h3>Image Preview</h3>
      <div class="preview-actions">
        <button class="preview-btn remove-btn" onclick="removeImage()">
          <i class="fas fa-trash"></i> Remove
        </button>
      </div>
    </div>
    <img id="preview" alt="Image preview" />
  </div>

  <!-- Settings -->
  <div class="settings-panel">
    <h3><i class="fas fa-cog"></i> OCR Settings</h3>
    <div class="setting-group">
      <label for="languageSelect"><i class="fas fa-language"></i> Language</label>
      <select id="languageSelect">
        <option value="eng">English</option>
        <option value="spa">Spanish</option>
        <option value="fra">French</option>
        <option value="deu">German</option>
        <option value="ita">Italian</option>
        <option value="por">Portuguese</option>
        <option value="rus">Russian</option>
      </select>
    </div>
  </div>

  <!-- Status -->
  <div class="status-container">
    <div id="statusText" class="status-info">
      <i class="fas fa-info-circle"></i> Upload an image to begin
    </div>
  </div>

  <!-- Process Button -->
  <button class="process-btn" id="processBtn" onclick="startOCR()" disabled>
    <i class="fas fa-play"></i> Start OCR Processing
  </button>

  <!-- Progress -->
  <div class="progress-container" id="progressContainer">
    <div class="progress-header">
      <h3><i class="fas fa-sync-alt"></i> Processing</h3>
      <span id="progressPercent">0%</span>
    </div>
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>
    <div class="progress-info">
      <div>Status: <span id="progressStatus">Ready</span></div>
      <div>Time: <span id="progressTime">0s</span></div>
    </div>
  </div>

  <!-- Output -->
  <div class="output-container" id="outputContainer">
    <div class="output-header">
      <h3><i class="fas fa-file-alt"></i> Extracted Text</h3>
      <div class="output-stats">
        <div class="stat-item" id="wordCount">0 words</div>
        <div class="stat-item" id="charCount">0 chars</div>
      </div>
    </div>
    <textarea id="output" placeholder="Extracted text will appear here..."></textarea>
    <div class="output-actions">
      <button class="action-btn copy-btn" onclick="copyText()">
        <i class="fas fa-copy"></i> Copy
      </button>
      <button class="action-btn save-btn" onclick="saveText()">
        <i class="fas fa-save"></i> Save
      </button>
      <button class="action-btn clear-btn" onclick="clearText()">
        <i class="fas fa-eraser"></i> Clear
      </button>
      <button class="action-btn download-btn" onclick="downloadText()">
        <i class="fas fa-download"></i> Download
      </button>
    </div>
  </div>

  <div class="footer">
    <i class="fas fa-lock"></i>
    <span>Processing happens locally in your browser</span>
  </div>
</div>

<script>
  // DOM Elements
  const imageInput = document.getElementById('imageInput');
  const uploadContainer = document.getElementById('uploadContainer');
  const previewContainer = document.getElementById('previewContainer');
  const preview = document.getElementById('preview');
  const processBtn = document.getElementById('processBtn');
  const progressContainer = document.getElementById('progressContainer');
  const progressFill = document.getElementById('progressFill');
  const progressPercent = document.getElementById('progressPercent');
  const progressStatus = document.getElementById('progressStatus');
  const progressTime = document.getElementById('progressTime');
  const outputContainer = document.getElementById('outputContainer');
  const output = document.getElementById('output');
  const statusText = document.getElementById('statusText');
  const languageSelect = document.getElementById('languageSelect');
  const wordCount = document.getElementById('wordCount');
  const charCount = document.getElementById('charCount');

  // State variables
  let currentFile = null;
  let isProcessing = false;
  let startTime = null;
  let timerInterval = null;

  // Initialize
  document.addEventListener('DOMContentLoaded', init);

  function init() {
    setupEventListeners();
  }

  function setupEventListeners() {
    // File input
    imageInput.addEventListener('change', handleFileSelect);
    
    // Drag and drop
    uploadContainer.addEventListener('dragover', handleDragOver);
    uploadContainer.addEventListener('dragleave', handleDragLeave);
    uploadContainer.addEventListener('drop', handleDrop);
    
    // Click upload container
    uploadContainer.addEventListener('click', (e) => {
      if (!e.target.classList.contains('upload-btn')) {
        imageInput.click();
      }
    });
  }

  function handleFileSelect(e) {
    const file = e.target.files[0];
    if (!file) return;
    
    loadImage(file);
  }

  function handleDragOver(e) {
    e.preventDefault();
    uploadContainer.classList.add('dragover');
    updateStatus('Drop image to upload', 'info');
  }

  function handleDragLeave(e) {
    e.preventDefault();
    uploadContainer.classList.remove('dragover');
    updateStatus('Upload an image to begin', 'info');
  }

  function handleDrop(e) {
    e.preventDefault();
    e.stopPropagation();
    uploadContainer.classList.remove('dragover');
    
    const file = e.dataTransfer.files[0];
    if (!file) return;
    
    loadImage(file);
  }

  function loadImage(file) {
    // Validate file
    if (!file.type.startsWith('image/')) {
      updateStatus('Please select an image file', 'error');
      return;
    }
    
    if (file.size > 10 * 1024 * 1024) {
      updateStatus('File too large (max 10MB)', 'error');
      return;
    }
    
    // Store file
    currentFile = file;
    
    // Show preview
    const reader = new FileReader();
    reader.onload = function(e) {
      preview.src = e.target.result;
      previewContainer.style.display = 'block';
    };
    reader.readAsDataURL(file);
    
    // Enable process button
    processBtn.disabled = false;
    updateStatus('Image loaded. Click "Start OCR Processing"', 'success');
  }

  function removeImage() {
    previewContainer.style.display = 'none';
    imageInput.value = '';
    currentFile = null;
    processBtn.disabled = true;
    outputContainer.style.display = 'none';
    updateStatus('Upload an image to begin', 'info');
  }

  async function startOCR() {
    if (!currentFile || isProcessing) return;
    
    // Reset
    output.value = '';
    outputContainer.style.display = 'block';
    isProcessing = true;
    processBtn.disabled = true;
    progressContainer.style.display = 'block';
    
    // Start timer
    startTime = Date.now();
    startTimer();
    
    try {
      const language = languageSelect.value;
      
      updateStatus('Initializing OCR engine...', 'info');
      updateProgress('Initializing', 0);
      
      // Load Tesseract worker
      const { createWorker } = Tesseract;
      const worker = await createWorker({
        logger: (m) => handleProgress(m),
      });
      
      await worker.load();
      await worker.loadLanguage(language);
      await worker.initialize(language);
      
      updateStatus('Processing image...', 'info');
      updateProgress('Processing', 30);
      
      // Perform OCR
      const { data } = await worker.recognize(currentFile);
      
      updateStatus('Finalizing...', 'info');
      updateProgress('Finalizing', 90);
      
      // Display results
      displayResults(data.text);
      
      updateStatus('OCR completed successfully!', 'success');
      updateProgress('Completed', 100);
      
      // Cleanup
      await worker.terminate();
      
    } catch (error) {
      console.error('OCR Error:', error);
      updateStatus('Error: ' + error.message, 'error');
      output.value = 'Error processing image. Please try again.\n\nError details: ' + error.message;
      updateTextStats();
    } finally {
      isProcessing = false;
      processBtn.disabled = false;
      clearInterval(timerInterval);
    }
  }

  function handleProgress(message) {
    if (message.status === 'recognizing text') {
      const progress = Math.min(90, Math.round(message.progress * 100));
      updateProgress('Extracting text', progress);
    }
  }

  function updateProgress(status, percent) {
    progressFill.style.width = percent + '%';
    progressPercent.textContent = percent + '%';
    progressStatus.textContent = status;
  }

  function startTimer() {
    clearInterval(timerInterval);
    timerInterval = setInterval(() => {
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      progressTime.textContent = elapsed + 's';
    }, 1000);
  }

  function displayResults(text) {
    const cleanedText = text.trim();
    output.value = cleanedText || 'No text detected in the image.';
    updateTextStats();
    output.scrollTop = 0;
  }

  function updateTextStats() {
    const text = output.value;
    const words = text.trim().split(/\s+/).filter(w => w.length > 0);
    wordCount.textContent = words.length + ' words';
    charCount.textContent = text.length + ' chars';
  }

  function updateStatus(message, type = 'info') {
    statusText.textContent = message;
    statusText.className = `status-${type}`;
    
    const icons = {
      success: 'fa-check-circle',
      error: 'fa-exclamation-circle',
      warning: 'fa-exclamation-triangle',
      info: 'fa-info-circle'
    };
    
    statusText.innerHTML = `<i class="fas ${icons[type]}"></i> ${message}`;
  }

  async function copyText() {
    const text = output.value;
    if (!text) return;
    
    try {
      await navigator.clipboard.writeText(text);
      showNotification('Text copied to clipboard!');
    } catch (err) {
      // Fallback
      output.select();
      document.execCommand('copy');
      showNotification('Text copied to clipboard!');
    }
  }

  function saveText() {
    const text = output.value;
    if (!text) return;
    
    const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'extracted-text.txt';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    showNotification('Text saved as file!');
  }

  function clearText() {
    output.value = '';
    updateTextStats();
    showNotification('Text cleared');
  }

  function downloadText() {
    const text = output.value;
    if (!text) return;
    
    const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'ocr-text-' + new Date().toISOString().slice(0, 10) + '.txt';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    showNotification('Text downloaded!');
  }

  function showNotification(message) {
    const notification = document.createElement('div');
    notification.textContent = message;
    notification.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--success);
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: var(--shadow);
      z-index: 1000;
      animation: slideIn 0.3s ease;
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.style.animation = 'slideOut 0.3s ease';
      setTimeout(() => {
        document.body.removeChild(notification);
      }, 300);
    }, 3000);
  }

  // Add animation styles
  const style = document.createElement('style');
  style.textContent = `
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideOut {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(100%); opacity: 0; }
    }
  `;
  document.head.appendChild(style);
</script>

<!-- Load Tesseract.js from CDN -->
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>

</body>
</html>
